## 分布式缓存设计

常见缓存方案为分层缓存，分为以下几个层级：

* 查询本地缓存，命中则直接返回；
* 没有命中则查询分布式缓存，如：Redis
* 分布式缓存没有命中需要到Tomcat本地堆进行查询，命中之后异步写回Redis；
* 以上都没有命中则从DB或数据源进行查询，并写回到Redis

## 缓存负载策略

缓存负载一般有下面两种策略：

* 轮询机制
* 一致哈希算法

轮询机制的优点是负载到各个服务器的请求是均匀的，但如果进行扩容缓存命中率会下降；

一致哈希的优点是相同的请求会负载到同一台服务器上，命中率不会因扩容而降低，但有大流量的时候会把服务器拖垮。

建议方案：首先采用一致哈希，当流量达到一定阈值时切换为轮询，既保证命中率又保证系统可用性。





